<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Quickly Create Peace Years for BTSCS Models with sbtscs in stevemisc | Aditya Karanam</title>
  <meta name="description" content="I have my first attempt at an R package, stevemisc, available on my github. It can help you quickly generate peace years for BTSCS models.">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://localhost:4000/blog/2017/06/quickly-create-peace-years-for-btscs-models-with-stevemisc/">
  <link rel="alternate" type="application/rss+xml" title="Aditya Karanam" href="http://localhost:4000/feed.xml" />
<link rel='stylesheet' id='open-sans-css'  href='//fonts.googleapis.com/css?family=Open+Sans%3A300italic%2C400italic%2C600italic%2C300%2C400%2C600&#038;subset=latin%2Clatin-ext&#038;ver=4.2.4' type='text/css' media='all' />
<link href='http://fonts.googleapis.com/css?family=Roboto:200' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Titillium+Web:600italic,600,400,400italic' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="https://www.osu.edu/assets/fonts/webfonts.css">
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
<link rel="stylesheet" href="/css/academicons-1.8.0/css/academicons.css">

<!-- icon, perhaps -->
<link rel="icon" type="image/png" href="/images/icon.png">
<link rel="apple-touch-icon" type="image/png" href="/images/icon-192.png">


<!-- OG protocol -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Quickly Create Peace Years for BTSCS Models with sbtscs in stevemisc">
<meta property="og:description" content="I have my first attempt at an R package, stevemisc, available on my github. It can help you quickly generate peace years for BTSCS models.">
<meta property="og:url" content="http://localhost:4000/blog/2017/06/quickly-create-peace-years-for-btscs-models-with-stevemisc/">
<meta property="og:site_name" content="Aditya Karanam">
<meta property="og:image" content="http://localhost:4000/images/buckeyeprotesteriran.jpg">

<meta property="og:image:width" content="637" />
<meta property="og:image:height" content="403" />

<!-- Twitter cards -->

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@aditya_karanam">
<meta name="twitter:title" content="Quickly Create Peace Years for BTSCS Models with sbtscs in stevemisc" />
<meta name="twitter:description" content="I have my first attempt at an R package, stevemisc, available on my github. It can help you quickly generate peace years for BTSCS models." />
<meta name="twitter:url" content="http://localhost:4000/blog/2017/06/quickly-create-peace-years-for-btscs-models-with-stevemisc/" />
<meta name="twitter:image" content="http://localhost:4000/images/buckeyeprotesteriran-card.jpg">


<link rel="author" href=""/>
<meta name="google-site-verification" content="" />
<meta name="msvalidate.01" content="" />
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">Aditya Karanam</a>


    <nav class="site-nav">

      <a href="#" class="menu-icon menu.open">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>  

    <div class="trigger"><h1>Main Navigation</h1>

 <ul class="menu">

    
    
     <li><a href="/about/" class="page-link">About</a>
    
    </li>
    
    
     <li><a href="/research/" class="page-link">Research</a>
    
    </li>
    
    
     <li><a href="/cv/" class="page-link">CV</a>
    
    </li>
    
    </ul>


<!-- <ul class="menu">
        <li> <a class="page-link" href="/about">About</a></li>
        <li> <a class="page-link"  href="/blog">Blog</a>
        <li> <a class="page-link" href="/blog">CV</a>
        <li> <a class="page-link" href="/blog">For Students</a></li>
        <li> <a class="page-link"  href="/blog">Research</a></a>
        <li> <a class="page-link" href="/blog">Teaching</a>
<ul class="sub-menu">
	<li><a href="http://svmiller.com/teaching/posc-1020-introduction-to-international-relations/">POSC 1020 – Introduction to International Relations</a></li>
	<li><a href="http://svmiller.com/teaching/posc-3410-quantitative-methods-in-political-science/">POSC 3410 – Quantitative Methods in Political Science</a></li>
	<li><a href="http://svmiller.com/teaching/posc-3610-international-politics-in-crisis/">POSC 3610 – International Politics in Crisis</a></li>
	<li><a href="http://svmiller.com/teaching/posc-3630-united-states-foreign-policy/">POSC 3630 – United States Foreign Policy</a></li>
</ul></li>
        <li> <a class="page-link" href="/blog">Miscellany</a>
<ul class="sub-menu">
	<li><a href="http://svmiller.com/teaching/posc-1020-introduction-to-international-relations/">Clean USAID Greenbook Data</a></li>
	<li><a href="http://svmiller.com/teaching/posc-3410-quantitative-methods-in-political-science/">Journal of Peace Research *.bst File</a></li>
	<li><a href="http://svmiller.com/teaching/posc-3610-international-politics-in-crisis/">My Custom Beamer Style</a></li>
</ul> 

</li>
</ul> -->

     </div>  
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">Quickly Create Peace Years for BTSCS Models with sbtscs in stevemisc</h1>
    <p class="post-meta">Posted on June 26, 2017 by  steve  

  in
  
  <a href="/categories/#R" title="R">R</a>&nbsp;
  


</p>
  </header>

  <article class="post-content">
    <p>Scholars may find themselves needing to control for temporal dependence in their analysis of event data. International relations scholars know this problem well. It arises when the likelihood of an event occurring—prominently: a militarized interstate dispute (MID) in the IR literature—depends, in part, on the time since the last event. Longer “peace spells” beget a decreasing likelihood of the onset of a MID whereas short “peace spells” make states more prone to another MID onset. Contrast India-Pakistan with, say, USA-Canada.</p>

<p>Dave Armstrong’s <code class="language-plaintext highlighter-rouge">DAMisc</code> package provides a useful function for creating these peace years, but my own research encounters problems with implementation. Both are related. One, the function is slow when used on a large data set. The time to estimate increases noticeably with larger data frames that get into the hundreds of thousands.</p>

<p>Further, it throws an error—and I don’t know why—when a lot of cross-sectional units don’t have an event onset. Scholars who work with Correlates of War data know this problem well. It’s the “rare event” problem that confounds simple maximum likelihood estimation. In a “politically relevant” sampling frame, MIDs still occur less than 5% of the time. If, for some reason, you want to flood your sampling frame with politically irrelevant cross-sections (e.g. Mongolia-Nigeria, Belize-Botswana), the data get into the hundreds of thousands and the likelihood of an event dips to around .5% of the data. This comment is more a critique of our most commonly used event data in international relations than it is of the <code class="language-plaintext highlighter-rouge">btscs</code> function, but many “peace science” folks in our discipline will still encounter this problem.</p>

<p>This leads to some frustrating coding problems. The <code class="language-plaintext highlighter-rouge">btscs</code> function is slow to run and will sometimes throw an error when a large number of cross-sections don’t have events. I created my <code class="language-plaintext highlighter-rouge">sbtscs</code> function, for which I fully confess I liberally copied a large part of Dave Armstrong’s code, for my own research. You may find it useful too.</p>

<p>Let me first note some of the problems I routinely encounter when trying to create peace-years in R. First, here’s the <code class="language-plaintext highlighter-rouge">btscs</code> function in the <code class="language-plaintext highlighter-rouge">DAMisc</code> package. Observe what happens when I try to run it on a non-directed, politically-irrelevant dyad-year sampling frame of the Gibler-Miller-Little (GML) MID data.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">DAMisc</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">RCurl</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span><span class="w">

</span><span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">getURL</span><span class="p">(</span><span class="s2">"https://raw.githubusercontent.com/svmiller/gml-mid-data/master/gml-ndy.csv"</span><span class="p">)</span><span class="w">
</span><span class="n">NDY</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">tbl_df</span><span class="p">()</span><span class="w">

</span><span class="n">NDY</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">mutate</span><span class="p">(</span><span class="n">midongoing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ifelse</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">midongoing</span><span class="p">),</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w">
           </span><span class="n">midonset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ifelse</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">midonset</span><span class="p">),</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w">
           </span><span class="n">dyad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">paste0</span><span class="p">(</span><span class="s2">"1"</span><span class="p">,</span><span class="n">sprintf</span><span class="p">(</span><span class="s2">"%03d"</span><span class="p">,</span><span class="w"> </span><span class="n">ccode1</span><span class="p">),</span><span class="w"> 
                                    </span><span class="n">sprintf</span><span class="p">(</span><span class="s2">"%03d"</span><span class="p">,</span><span class="w"> </span><span class="n">ccode2</span><span class="p">))))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">arrange</span><span class="p">(</span><span class="n">dyad</span><span class="p">,</span><span class="n">year</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">select</span><span class="p">(</span><span class="n">ccode1</span><span class="p">,</span><span class="w"> </span><span class="n">ccode2</span><span class="p">,</span><span class="w"> </span><span class="n">dyad</span><span class="p">,</span><span class="w"> </span><span class="n">year</span><span class="p">,</span><span class="w"> </span><span class="n">midongoing</span><span class="p">,</span><span class="w"> </span><span class="n">midonset</span><span class="p">,</span><span class="w"> </span><span class="n">dispnum3</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">as.data.frame</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">NDY</span><span class="w">

</span><span class="c1"># this_wont_work &lt;- btscs(NDY, "midongoing", "year", "dyad")</span><span class="w">
</span><span class="c1">#  Error in if (x[j] == 0 &amp; x[(j - 1)] == 0) { : </span><span class="w">
</span><span class="c1"># missing value where TRUE/FALSE needed </span><span class="w">
</span></code></pre></div></div>

<p>My <code class="language-plaintext highlighter-rouge">sbtscs</code> (vainly: steve’s btscs function) will run, and run pretty quick.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">stevemisc</span><span class="p">)</span><span class="w">
</span><span class="n">NDYpy</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sbtscs</span><span class="p">(</span><span class="n">NDY</span><span class="p">,</span><span class="w"> </span><span class="n">midongoing</span><span class="p">,</span><span class="w"> </span><span class="n">year</span><span class="p">,</span><span class="w"> </span><span class="n">dyad</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">tbl_df</span><span class="p">()</span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">NDYpy</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## # A tibble: 6 x 8
##   ccode1 ccode2    dyad  year midongoing midonset dispnum3 spell
##    &lt;int&gt;  &lt;int&gt;   &lt;dbl&gt; &lt;int&gt;      &lt;dbl&gt;    &lt;dbl&gt;    &lt;int&gt; &lt;dbl&gt;
## 1      2     20 1002020  1920          0        0       NA     0
## 2      2     20 1002020  1921          0        0       NA     1
## 3      2     20 1002020  1922          0        0       NA     2
## 4      2     20 1002020  1923          0        0       NA     3
## 5      2     20 1002020  1924          0        0       NA     4
## 6      2     20 1002020  1925          0        0       NA     5
</code></pre></div></div>

<p>Further, there is a major speed advantage to <code class="language-plaintext highlighter-rouge">sbtscs</code> since it leans on <code class="language-plaintext highlighter-rouge">dplyr</code> to handle the cross-sections without events.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">NDY</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">ccode1</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">110</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Guyana1</span><span class="w">

</span><span class="n">system.time</span><span class="p">(</span><span class="n">PY1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sbtscs</span><span class="p">(</span><span class="n">Guyana1</span><span class="p">,</span><span class="w"> </span><span class="n">midongoing</span><span class="p">,</span><span class="w"> </span><span class="n">year</span><span class="p">,</span><span class="w"> </span><span class="n">dyad</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##    user  system elapsed 
##   1.143   0.042   1.189
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">system.time</span><span class="p">(</span><span class="n">PY2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">btscs</span><span class="p">(</span><span class="n">Guyana1</span><span class="p">,</span><span class="w"> </span><span class="s2">"midongoing"</span><span class="p">,</span><span class="w"> </span><span class="s2">"year"</span><span class="p">,</span><span class="w"> </span><span class="s2">"dyad"</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##    user  system elapsed 
##   12.85   13.57   26.53
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">identical</span><span class="p">(</span><span class="n">PY1</span><span class="o">$</span><span class="n">spell</span><span class="p">,</span><span class="w"> </span><span class="n">PY2</span><span class="o">$</span><span class="n">spell</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] TRUE
</code></pre></div></div>

<p>Feel free to yell at me on <a href="https://github.com/svmiller">my Github</a>. Whereas this is my first hack at programming, I’m all-ears for feedback.</p>

  </article>

<div id="disqus_thread"></div>
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'svmiller';
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

<!--     <h2 class="footer-heading">Aditya Karanam</h2> -->

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li><strong>Aditya Karanam</strong></li>
			<li>PhD Student</li>
          <li><a href="mailto:aditya_ks@utexas.edu">aditya_ks@utexas.edu</a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
 

         <p class="text">
		Department of Information, Risk, & Operations Management,<br />
		McCombs School of Business, <br />
    2110 Speed Way<br />
		Austin, TX 78705</p> <!-- I'm a PhD Student at McCombs School of Business, UT, Austin with research interests in the area of Economics of Information Systems. Specifically, I am interested in New product design and Innovation. Topics on my site include my research interests and teaching.
 -->
      </div>

      <div class="footer-col  footer-col-3">
       <ul class="social-media-list">

                  
     

          
  <li>
    <a href="https://github.com/askaranam">
      <i class="fa fa-github" style="color:gray"></i> Github
    </a>
  </li>


          

          
  <li>
    <a href="https://twitter.com/aditya_karanam">
      <i class="fa fa-twitter" style="color:gray"></i> Twitter
    </a>
  </li>







       
        </ul>
      </div>
    </div>

  </div>

</footer>

		<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-37298398-1']);
	_gaq.push(['_trackPageview']);
	(function() {
	var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
	</script>
  </body>
</html>
<!-- d.s.m.s.050600.062508.030515.080516.030818; k.050800.101218 | "Baby, I'm Yours" -->

